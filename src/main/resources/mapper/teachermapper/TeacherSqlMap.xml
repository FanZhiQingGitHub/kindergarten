<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!--TeacherMapper的位置-->
<mapper namespace="com.great.kindergarten.teacher.mapper.TeacherMapper">

    <!--    com.great.kindergarten.director.javabean.-->
    <!--resultType先是传入的，parameterType是传-一样的话，其实是可以不用写的-->
    <resultMap id="teacherMap" type="TblTeacher">
        <result column="teacherid" property="teacherid"></result>
        <result column="teachername" property="teachername"></result>
        <result column="teacherpwd" property="teacherpwd"></result>
        <result column="teachersex" property="teachersex"></result>
        <result column="teacherage" property="teacherage"></result>
        <result column="teacheradd" property="teacheradd"></result>
        <result column="teacherphone" property="teacherphone"></result>
        <result column="teacherjob" property="teacherjob"></result>
        <result column="teacherregtime" property="teacherregtime"></result>
        <result column="teacherstatus" property="teacherstatus"></result>
        <result column="cid" property="cid"></result>
        <result column="rid" property="rid"></result>
    </resultMap>

    <resultMap id="classMap" type="TblClass">
        <result column="classid" property="classid"></result>
        <result column="classname" property="classname"></result>
        <result column="classregtime" property="classregtime"></result>
        <result column="classstatus" property="classstatus"></result>
    </resultMap>

    <resultMap id="courseMap" type="TblCourse">
        <result column="courseid" property="courseid"></result>
        <result column="coursenum" property="coursenum"></result>
        <result column="coursename1" property="coursename1"></result>
        <result column="coursename2" property="coursename2"></result>
        <result column="coursename3" property="coursename3"></result>
        <result column="coursename4" property="coursename4"></result>
        <result column="coursename5" property="coursename5"></result>
        <result column="cid" property="cid"></result>
    </resultMap>
    <resultMap id="workMap" type="TblWork">
        <result column="workid" property="workid"></result>
        <result column="workreleaseid" property="workreleaseid"></result>
        <result column="workurl" property="workurl"></result>
        <result column="workreleaseid" property="workreleaseid"></result>
        <result column="wfinishtime" property="wfinishtime"></result>
        <result column="workresult" property="workresult"></result>
        <result column="workeva" property="workeva"></result>
        <result column="studentname" property="studentname"></result>
        <result column="parentname" property="parentname"></result>
        <result column="cid" property="cid"></result>
        <result column="wfinishtime" property="wfinishtime"></result>
    </resultMap>

    <resultMap id="safetyMap" type="TblSafetyvideo">
        <id column="safetyvideoid" property="safetyvideoid"></id>
        <result column="safetyvideoid" property="safetyvideoid"></result>
        <result column="safetyvideoname" property="safetyvideoname"></result>
        <result column="safetyvideotime" property="safetyvideotime"></result>
        <result column="safetyfinishtime" property="safetyfinishtime"></result>

        <result column="safetyvideoplace" property="safetyvideoplace"></result>
        <result column="mid" property="mid"></result>
        <result column="videoname" property="videoname"></result>
        <result column="videoadd" property="videoadd"></result>
    </resultMap>




    <!--用户状态查询-->
    <select id="findTeacherStatus" resultType="java.lang.String" parameterType="java.util.Map">
        select teacherstatus from tbl_teacher where teachername=#{teachername}
    </select>

    <!--用户登录查询-->
    <select id="findTeacher" resultMap="teacherMap" parameterType="TblTeacher">
		select * from tbl_teacher
        <where>
            <if test="teachername!='' and teachername!=null">
                and teachername = #{teachername}
            </if>
            <if test=" teacherpwd !='' and teacherpwd!=null">
                and teacherpwd = #{teacherpwd}
            </if>
        </where>
	</select>
<!--       根据id查信息-->
    <select id="checkPwd" resultMap="teacherMap" parameterType="java.lang.Integer">
        select * from tbl_teacher where teacherid = #{teacherid};
    </select>
    <!--修改密码-->
    <update id="updateTeacherPwd" parameterType="java.util.Map">
        UPDATE tbl_teacher SET teacherpwd = #{teacherpwd} where teacherid = #{teacherid};
    </update>
<!--    根据cid查班级名称-->
    <select id="findClassAll" resultMap="classMap" parameterType="java.lang.Integer">
        select * from tbl_class where classid = #{cid};
    </select>
    <!--    根据cid查班级课程-->
    <select id="findCourse" resultMap="courseMap" parameterType="java.lang.Integer">
        select * from tbl_course where cid = #{cid};
    </select>
    <!--查询数据总数量-->
    <select id="findCount" resultType="java.lang.Integer" >
			select count(*) from tbl_course
	</select>
<!--    查班级所有名称-->
    <select id="findClassName" resultMap="classMap" >
        select * from tbl_class;
    </select>
<!--    根据班级名查找id-->
    <select id="findClassidByName" resultType="java.lang.Integer" parameterType="TblClass">
			select classid from tbl_class where classname=#{classname};
	</select>
    <!--    作业文件上传记录-->
    <insert id="addFileInfo" parameterType="TblWorkrelease">
        insert into tbl_workrelease
        (workreleasedetail,worklocation,workreleasetime,cid)
        values (#{workreleasedetail},#{worklocation},now(),#{cid});
    </insert>
<!--    查找班级所有作业信息-->
    <select id="findWork" resultType="TblWork" parameterType="java.lang.Integer">
        select * from tbl_work where cid = #{cid};
    </select>
    <!--    查作业表-->
    <select id="findWorkTable" resultMap="workMap" parameterType="TblWork">
    select w.sid,w.studentname,w.parentname,b.workreleasetime,w.wfinishtime
    from tbl_work w,(select workreleasetime from tbl_workrelease where workreleaseid=#{workreleaseid}) b where cid = #{cid};
    </select>
    <!--查询作业数据总数量-->
    <select id="findWorkCount" resultType="java.lang.Integer" parameterType="java.lang.Integer">
			select count(*) from tbl_work where cid = #{cid};
	</select>
<!--    打分-->
    <update id="workScore" parameterType="java.util.Map">
        UPDATE tbl_work SET workeva = #{score} where sid = #{sid};
    </update>
    <!--查询安全视频总数量-->
    <select id="findSafetyCount" resultType="java.lang.Integer" >
			select count(*) from tbl_safetyvideo ;
	</select>
<!--    查询安全视频表-->
    <select id="findSafetyTable" resultMap="safetyMap" parameterType="HashMap">
        select * from tbl_safetyvideo limit #{pageInt},#{limitInt}
    </select>
<!--    新增安全教育视频-->
    <insert id="uploadVideo" parameterType="TblSafetyvideo">
        insert into tbl_safetyvideo
        (safetyvideoname,safetyvideotime,safetyfinishtime,videoadd)
        values (#{safetyvideoname},#{safetyvideotime},#{safetyfinishtime},#{videoadd});
    </insert>
</mapper>
