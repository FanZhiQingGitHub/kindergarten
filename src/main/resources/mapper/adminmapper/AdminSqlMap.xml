<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.great.kindergarten.admin.mapper.AdminMapper">

    <resultMap id="AdminMap" type="com.great.kindergarten.commons.entity.TblAdmin">
        <result column="adminid" property="adminid"/>
        <result column="adminname" property="adminname"/>
        <result column="adminpwd" property="adminpwd"/>
        <result column="createtime" property="createtime"/>
        <result column="adminstatus" property="adminstatus"/>
        <result column="rid" property="rid"/>
    </resultMap>

    <insert id="addKinder" parameterType="java.util.List">
        insert into
        tbl_kinder(kindername,kinderlp,kinderlpid,kinderlpadd,kinderlpphone,schoolpermit,healthpermit,firepermit,grouppermit,registrationpermit,kinderapptime,kinderregtime,kinderstatus,kinderacount,kindercode,kinderpwd,kinderscale,kinderfunds)
        values
        <foreach collection="list" item="i" index="index" separator=",">
            (#{i.kindername},#{i.kinderlp},#{i.kinderlpid},#{i.kinderlpadd},#{i.kinderlpphone},#{i.schoolpermit},#{i.healthpermit},#{i.firepermit},#{i.grouppermit},#{i.registrationpermit},#{i.kinderapptime},#{i.kinderregtime},#{i.kinderstatus},#{i.kinderacount},#{i.kindercode},#{i.kinderpwd},#{i.kinderscale},#{i.kinderfunds})
        </foreach>
    </insert>

    <insert id="addMenuInfo">
        insert into
        tbl_menu(menuname,menuurl,menusonid,sort)
        values (#{menuname},#{menuurl},#{menusonid},#{sort})
    </insert>
    <insert id="addRoleInfo">
        insert into
            tbl_role(rolename) values (#{rolename})
    </insert>
    <insert id="addPhotoImg">
        insert into
           tbl_readmag(readmagname, readmagurl, readmagdetail, readmagtime, readmagpage, photourl)
           values (#{readmagname},#{readmagurl},#{readmagdetail},#{readmagtime},#{readmagpage},#{photourl})
    </insert>


    <insert id="addPlatFormInfo">
        insert into
            tbl_platforminfo(platforminfoname, platforminfotime, platforminfodetail, platforminfostatus)
            values (#{platforminfoname},#{platforminfotime},#{platforminfodetail},#{platforminfostatus})
    </insert>


    <!--新增园长-->
    <insert id="addRector">
        insert into
            tbl_rector(rectorname, rectorpwd, rectorsex, rectorage, rectoradd, rectorphone, rectorregtime, rectorstatus, rid)
            values
            <foreach collection="list" item="i" index="index" separator=",">
                (#{i.rectorname},#{i.rectorpwd},#{i.rectorsex},#{i.rectorage},#{i.rectoradd},#{i.rectorphone},#{i.rectorregtime},#{i.rectorstatus},#{i.rid})
            </foreach>
    </insert>

    <insert id="addTeacher">
        insert into
        tbl_teacher(teachername, teacherpwd, teachersex, teacherage, teacherjob, teacheradd, teacherphone, teacherregtime, teacherstatus, rid)
        values
        <foreach collection="list" item="i" index="index" separator=",">
            (#{i.teachername},#{i.teacherpwd},#{i.teachersex},#{i.teacherage},#{i.teacherjob},#{i.teacheradd},#{i.teacherphone},#{i.teacherregtime},#{i.teacherstatus},#{i.rid})
        </foreach>
    </insert>
    <insert id="addParent">
        insert into
            tbl_parent(parentname, parentpwd, parentsex, parentage, parentadd, parentphone, parentson, parentjob, parentregtime, parentstatus, rid)
            values
            <foreach collection="list" item="i" index="index" separator=",">
                (#{i.parentName},#{i.parentPwd},#{i.parentSex},#{i.parentAge},#{i.parentJob},#{i.parentAdd},#{i.parentPhone},#{i.parentRegTime},#{i.parentStatus},#{i.rid})
            </foreach>
    </insert>
    <insert id="addHealther">
        insert into
            tbl_healther(healthername, healtherpwd, healthersex, healtherage, healtheradd, healtherphone, healtherregtime, healtherstatus, rid)
            values
            <foreach collection="list" item="i" index="index" separator=",">
                (#{i.healthername},#{i.healtherpwd},#{i.healthersex},#{i. healtherage},#{i.healtheradd},#{i.healtherphone},#{i.healtherregtime},#{i.healtherstatus},#{i.rid})
            </foreach>
    </insert>
    <insert id="addSecurity">
        insert into
            tbl_security(securityname, securitypwd, securitysex, securityage, securityadd, securityphone, securityregtime, securitystatus, rid)
            values
            <foreach collection="list" item="i" index="index" separator=",">
                (#{i.securityname},#{i.securitypwd},#{i.securitysex},#{i.securityage},#{i.securityadd},#{i.securityphone},#{i.securityregtime},#{i.securitystatus},#{i.rid})
            </foreach>
    </insert>
    <insert id="addStudent">
        insert into
            tbl_student(studentname, studentpwd, studentsex, studentbrith, studentadd, studenttime, studentstatus, cid, pid, kid, rid)
            values
            <foreach collection="list" item="i" index="index" separator=",">
                (#{i.studentname},#{i.studentpwd},#{i.studentsex},#{i. studentbrith},#{i.studentadd},#{i.studenttime},#{i.studentstatus},#{i.cid},#{i.kid},#{i.rid})
            </foreach>
    </insert>
    <insert id="addSafetyVideo">
        insert into
        tbl_safetyvideo(safetyvideoname, safetyvideotime, safetyfinishtime, safetyvideoplace, mid, videoname, videoadd)
        values
        <foreach collection="list" item="i" index="index" separator=",">
            (#{i.safetyvideoname},#{i.safetyvideotime},#{i.safetyfinishtime},#{i.safetyvideoplace},#{i.mid},#{i.videoname},#{i.videoadd})
        </foreach>
    </insert>
    <insert id="addTopic">
        insert into
            tbl_safetyvtq(safetyvtqname, a, avalue, b, bvalue, c, cvalue, d, dvalue, safetyvideoid)
            values (#{safetyvtqname},#{a},#{avalue},#{b},#{bvalue},#{c},#{cvalue},#{d},#{dvalue},#{safetyvideoid})
    </insert>
    <insert id="addParameter">
        insert into
            tbl_parameter(parametername, parameterval, parametertype, stid, svid)
            values
        <foreach collection="list" item="i" index="index" separator=",">
            (#{i.parametername},#{i.parameterval},#{i.parametertype},#{i.stid},#{i.svid})
        </foreach>
    </insert>

    <insert id="updateMenu" parameterType="java.util.List">
        insert into tbl_rolemenu(rid, mid) values
        <foreach item="i" index="index" collection="list" separator=",">
            (#{i.rid},#{i.mid})
        </foreach>
    </insert>

    <!--新增管理员账号-->
    <insert id="addAdminInfos">
        insert into tbl_admin
            (adminname, adminpwd, adminsex, adminphone, adminheadurl, createtime, adminstatus, rid)
            values(#{adminname},#{adminpwd},#{adminsex},#{adminphone},#{adminheadurl},#{createtime},#{adminstatus},#{rid})
    </insert>


    <delete id="deleteKinderInfo">
        delete from tbl_kinder where kinderid = #{kinderid}
    </delete>


    <delete id="deleteMenuInfo">
        delete from tbl_menu where menuid = #{menuid}
    </delete>


    <delete id="deleteRoleMenu">
        delete from tbl_rolemenu where rolemenuid = #{rolemenuid}
    </delete>


    <delete id="deleteRoleInfo">
        delete from tbl_role where roleid = #{roleid}
    </delete>


    <delete id="deleteReadInfo">
         delete from tbl_readmag where readmagid = #{readmagid}
    </delete>


    <delete id="deletePlatFormInfo">
        delete from tbl_platforminfo where platforminfoid = #{platforminfoid}
    </delete>


    <delete id="deleteRector">
        delete from tbl_rector where rectorid = #{rectorid}
    </delete>


    <delete id="deleteTeacher">
        delete from tbl_teacher where teacherid = #{teacherid}
    </delete>


    <delete id="deleteParent">
        delete from tbl_parent where parentid = #{parentId}
    </delete>


    <delete id="deleteHealther">
        delete from tbl_healther where healtherid = #{healtherid}
    </delete>


    <delete id="deleteSecurity">
        delete from tbl_security where securityid = #{securityid}
    </delete>


    <delete id="deleteStudent">
        delete from tbl_student where studentid = #{studentid}
    </delete>


    <delete id="deleteSafetyVideoInfo">
        delete from tbl_safetyvideo where safetyvideoid = #{safetyvideoid}
    </delete>


    <delete id="deleteTopic">
        delete from tbl_safetyvtq where safetyvtqid = #{safetyvtqid}
    </delete>


    <delete id="deleteParameter">
        delete from tbl_parameter where parameterid = #{parameterid}
    </delete>


    <delete id="deleteMenuId">
        delete from tbl_rolemenu where rid = #{roleid}
    </delete>


    <delete id="deleteAdmin">
        delete from tbl_admin where adminid = #{adminid}
    </delete>


    <!--    用户状态查询-->
    <select id="findAdminStatus" resultType="java.lang.String" parameterType="java.util.Map">
        select adminstatus from tbl_admin
        <where>
            <if test="adminname != '' and adminname != null ">
                and adminname = #{adminname}
            </if>
        </where>
    </select>

    <!--    用户登录-->
    <select id="adminLogin" resultMap="AdminMap" parameterType="java.util.Map">
        select * from tbl_admin
        <where>
            <if test="adminname != '' and adminname != null ">
                and adminname = #{adminname}
            </if>
            <if test="adminpwd != '' and adminpwd != null ">
                and adminpwd = #{adminpwd}
            </if>
        </where>
    </select>

    <select id="findMenuByName" resultType="com.great.kindergarten.commons.entity.TblMenu" parameterType="java.lang.String">
		select *
		from tbl_menu
		where menuid in (
			select mid
			from tbl_rolemenu R1
			where R1.rid in
				  (select R.roleid
				   from tbl_role R
							left join tbl_admin A on R.roleid = A.rid
				   where A.adminname = #{adminname} and menusonid = 0)
		)
	</select>

    <select id="findMenuBySid" resultType="com.great.kindergarten.commons.entity.TblMenu" parameterType="java.lang.Integer">
        select * from tbl_menu a, tbl_rolemenu b where a.menusonid = #{menusonid} and a.menuid = b.mid
    </select>

    <select id="findRoleByRid" resultType="java.lang.String">
        select rolename from tbl_role where roleid = #{roleid}
    </select>

    <resultMap id="AdminInfoMap" type="com.great.kindergarten.commons.entity.TblAdmin">
        <result column="adminid" property="adminid"></result>
        <result column="adminname" property="adminname"></result>
        <result column="adminpwd" property="adminpwd"></result>
        <result column="adminsex" property="adminsex"></result>
        <result column="adminphone" property="adminphone"></result>
        <result column="adminheadurl" property="adminheadurl"></result>
        <result column="adminstatus" property="adminstatus"></result>
        <result column="roleid" property="roleid"></result>
        <result column="rolename" property="rolename"></result>
        <result column="rid" property="rid"></result>
        <association property="tblRole" javaType="com.great.kindergarten.commons.entity.TblRole">
            <id property="roleid" column="roleid"/>
            <result property="roleid" column="roleid"/>
            <result property="rolename" column="rolename"/>
        </association>
    </resultMap>

    <select id="findAdminByName" resultMap="AdminInfoMap" parameterType="com.great.kindergarten.commons.entity.TblAdmin">
        select a.* ,r.rolename from tbl_admin a,tbl_role r
        <where>
            a.rid = r.roleid and a.adminname = #{adminname}
        </where>

    </select>

    <select id="findTblAdminByName" resultType="com.great.kindergarten.commons.entity.TblAdmin">
        select * from tbl_admin where adminname = #{adminname}
    </select>

    <update id="updateAdminPwd" parameterType="java.util.Map">
        update tbl_admin set adminpwd = #{adminpwd} where adminid = #{adminid};
    </update>
    <update id="checkQualify">
        update tbl_kinder
        <set>
            <if test="kinderstatus != '' and kinderstatus != null">
                kinderstatus = #{kinderstatus},
            </if>
            <if test="kinderapptime != '' and kinderapptime != null">
                kinderapptime = #{kinderapptime},
            </if>
        </set>
        where kinderid = #{kinderid}
    </update>
    <update id="updateKinderCode">
        update tbl_kinder
        <set>
            <if test="kindercode != '' and kindercode != null">
                kindercode = #{kindercode},
            </if>
        </set>
        where kinderid = #{kinderid}
    </update>
    <update id="restKinderPwd">
        update tbl_kinder
        <set>
            <if test="kinderpwd != '' and kinderpwd != null">
                kinderpwd = #{kinderpwd},
            </if>
        </set>
        where kinderid = #{kinderid}
    </update>
    <update id="updateKinderInfo">
        update tbl_kinder
        <set>
            <if test="kindername != '' and kindername != null">
                kindername = #{kindername},
            </if>
            <if test="kinderacount != '' and kinderacount != null">
                kinderacount = #{kinderacount},
            </if>
            <if test="kinderlp != '' and kinderlp != null">
                kinderlp = #{kinderlp},
            </if>
            <if test="kinderlpid != '' and kinderlpid != null">
                kinderlpid = #{kinderlpid},
            </if>
            <if test="kinderlpadd != '' and kinderlpadd != null">
                kinderlpadd = #{kinderlpadd},
            </if>
            <if test="kinderlpphone != '' and kinderlpphone != null">
                kinderlpphone = #{kinderlpphone},
            </if>
        </set>
        where kinderid = #{kinderid}
    </update>
    <update id="updateMenuInfo">
        update tbl_menu
        <set>
            <if test="menuname != '' and menuname != null">
                menuname = #{menuname},
            </if>
            <if test="menusonid != '' and menusonid != null">
                menusonid = #{menusonid},
            </if>
            <if test="menuurl != '' and menuurl != null">
                menuurl = #{menuurl},
            </if>
            <if test="sort != '' and sort != null">
                sort = #{sort},
            </if>
        </set>
        where menuid = #{menuid}
    </update>
    <update id="updateRoleInfo">
        update tbl_role
        <set>
            <if test="rolename != '' and rolename != null">
                rolename = #{rolename},
            </if>
        </set>
        where roleid = #{roleid}
    </update>
    <update id="reUploadBook">
        update tbl_readmag
        <set>
            <if test="readmagname != '' and readmagname != null">
                readmagname = #{readmagname},
            </if>
            <if test="readmagurl != '' and readmagurl != null">
                readmagurl = #{readmagurl},
            </if>
            <if test="readmagdetail != '' and readmagdetail != null">
                readmagdetail = #{readmagdetail},
            </if>
                readmagtime = now(),
            <if test="readmagpage != '' and readmagpage != null">
                readmagpage = #{readmagpage},
            </if>
            <if test="photourl != '' and photourl != null">
                photourl = #{photourl},
            </if>
        </set>
        where readmagid = #{readmagid}
    </update>
    <update id="releasePlatFormInfo">
        update tbl_platforminfo
        <set>
            <if test="platforminfostatus != '' and platforminfostatus != null">
                platforminfostatus = #{platforminfostatus},
            </if>
        </set>
        where platforminfoid = #{platforminfoid}
    </update>

    <update id="cancelPlatFormInfo">
        update tbl_platforminfo
        <set>
            <if test="platforminfostatus != '' and platforminfostatus != null">
                platforminfostatus = #{platforminfostatus},
            </if>
        </set>
        where platforminfoid = #{platforminfoid}
    </update>
    <update id="updatePlatFormInfo">
        update tbl_platforminfo
        <set>
            <if test="platforminfoname != '' and platforminfoname != null">
                platforminfoname = #{platforminfoname},
            </if>
            <if test="platforminfodetail != '' and platforminfodetail != null">
                platforminfodetail = #{platforminfodetail},
            </if>
            platforminfotime = now()
        </set>
        where platforminfoid = #{platforminfoid}
    </update>
    <update id="restRectorPwd">
        update tbl_rector
        <set>
            <if test="rectorpwd != '' and rectorpwd != null">
                rectorpwd = #{rectorpwd},
            </if>
        </set>
        where rectorid = #{rectorid}
    </update>
    <update id="updateRector">
        update tbl_rector
        <set>
            <if test="rectorpwd != '' and rectorpwd != null">
                rectorpwd = #{rectorpwd},
            </if>
            <if test="rectorphone != '' and rectorphone != null">
                rectorphone = #{rectorphone},
            </if>
            <if test="rectoradd != '' and rectoradd != null">
                rectoradd = #{rectoradd},
            </if>
            <if test="rectorstatus != '' and rectorstatus != null">
                rectorstatus = #{rectorstatus},
            </if>
            <if test="rectorage != '' and rectorage != null">
                rectorage = #{rectorage},
            </if>
        </set>
        where rectorid = #{rectorid}
    </update>
    <update id="updateRectorStatus">
         update tbl_rector
        <set>
            <if test="rectorstatus != '' and rectorstatus != null">
                rectorstatus = #{rectorstatus},
            </if>
        </set>
        where rectorid = #{rectorid}
    </update>

    <!--教师管理-->
    <update id="restTeacherPwd">
        update tbl_teacher
        <set>
            <if test="teacherpwd != '' and teacherpwd != null">
                teacherpwd = #{teacherpwd},
            </if>
        </set>
        where teacherid = #{teacherid}
    </update>
    <update id="updateTeacher">
        update tbl_teacher
        <set>
            <if test="teachername != '' and teachername != null">
                teachername = #{teachername},
            </if>
            <if test="teacherpwd != '' and teacherpwd != null">
                teacherpwd = #{teacherpwd},
            </if>
            <if test="teacherphone != '' and teacherphone != null">
                teacherphone = #{teacherphone},
            </if>
            <if test="teacheradd != '' and teacheradd != null">
                teacheradd = #{teacheradd},
            </if>
            <if test="teacherstatus != '' and teacherstatus != null">
                teacherstatus = #{teacherstatus},
            </if>
            <if test="teacherage != '' and teacherage != null">
                teacherage = #{teacherage},
            </if>
            <if test="teacherjob != '' and teacherjob != null">
                teacherjob = #{teacherjob},
            </if>
        </set>
        where teacherid = #{teacherid}
    </update>
    <update id="updateTeacherStatus">
        update tbl_teacher
        <set>
            <if test="teacherstatus != '' and teacherstatus != null">
                teacherstatus = #{teacherstatus},
            </if>
        </set>
        where teacherid = #{teacherid}
    </update>



    <!--家长管理-->
    <update id="updateParent">
        update tbl_parent
        <set>
            <if test="parentPwd != '' and parentPwd != null">
                parentpwd = #{parentPwd},
            </if>
            <if test="parentPhone != '' and parentPhone != null">
                parentphone = #{parentPhone},
            </if>
            <if test="parentAdd != '' and parentAdd != null">
                parentadd = #{parentAdd},
            </if>
            <if test="parentStatus != '' and parentStatus != null">
                parentstatus = #{parentStatus},
            </if>
            <if test="parentAge != '' and parentAge != null">
                parentage = #{parentAge},
            </if>
            <if test="parentJob != '' and parentJob != null">
                parentjob = #{parentJob},
            </if>
        </set>
        where parentid = #{parentId}
    </update>
    <update id="updateParentStatus">
        update tbl_parent
        <set>
            <if test="parentStatus != '' and parentStatus != null">
                parentstatus = #{parentStatus},
            </if>
        </set>
        where parentid = #{parentId}
    </update>
    <update id="restParentPwd">
        update tbl_parent
        <set>
            <if test="parentPwd != '' and parentPwd != null">
                parentpwd = #{parentPwd},
            </if>
        </set>
        where parentid = #{parentId}
    </update>



    <!--    保健员管理-->
    <update id="updateHealther">
        update tbl_healther
        <set>
            <if test="healtherpwd != '' and healtherpwd != null">
                healtherpwd = #{healtherpwd},
            </if>
            <if test="healtherphone != '' and healtherphone != null">
                healtherphone = #{healtherphone},
            </if>
            <if test="healtheradd != '' and healtheradd != null">
                healtheradd = #{healtheradd},
            </if>
            <if test="healtherstatus != '' and healtherstatus != null">
                healtherstatus = #{healtherstatus},
            </if>
            <if test="healtherage != '' and healtherage != null">
                healtherage = #{healtherage},
            </if>
        </set>
        where healtherid = #{healtherid}
    </update>
    <update id="updateHealtherStatus">
        update tbl_healther
        <set>
            <if test="healtherstatus != '' and healtherstatus != null">
                healtherstatus = #{healtherstatus},
            </if>
        </set>
        where healtherid = #{healtherid}
    </update>
    <update id="restHealtherPwd">
        update tbl_healther
        <set>
            <if test="healtherpwd != '' and healtherpwd != null">
                healtherpwd = #{healtherpwd},
            </if>
        </set>
        where healtherid = #{healtherid}
    </update>

    <!--    安防员管理-->
    <update id="updateSecurity">
        update tbl_security
        <set>
            <if test="securitypwd != '' and securitypwd != null">
                securitypwd = #{securitypwd},
            </if>
            <if test="securityphone != '' and securityphone != null">
                securityphone = #{securityphone},
            </if>
            <if test="securityadd != '' and securityadd != null">
                securityadd = #{securityadd},
            </if>
            <if test="securitystatus != '' and securitystatus != null">
                securitystatus = #{securitystatus},
            </if>
            <if test="securityage != '' and securityage != null">
                securityage = #{securityage},
            </if>
        </set>
        where securityid = #{securityid}
    </update>
    <update id="updateSecurityStatus">
        update tbl_security
        <set>
            <if test="securitystatus != '' and securitystatus != null">
                securitystatus = #{securitystatus},
            </if>
        </set>
        where securityid = #{securityid}
    </update>
    <update id="restSecurityPwd">
        update tbl_security
        <set>
            <if test="securitypwd != '' and securitypwd != null">
                securitypwd = #{securitypwd},
            </if>
        </set>
        where securityid = #{securityid}
    </update>

    <!--    学生管理-->
    <update id="updateStudent">
        update tbl_student
        <set>
            <if test="studentname != '' and studentname != null">
                studentname = #{studentname},
            </if>
            <if test="studentpwd != '' and studentpwd != null">
                studentpwd = #{studentpwd},
            </if>
            <if test="studentbrith != '' and studentbrith != null">
                studentbrith = #{studentbrith},
            </if>
            <if test="studentadd != '' and studentadd != null">
                studentadd = #{studentadd},
            </if>
            <if test="studentstatus != '' and studentstatus != null">
                studentstatus = #{studentstatus},
            </if>
            <if test="cid != null">
                cid = #{cid},
            </if>
            <if test="kid != null">
                kid = #{kid},
            </if>
        </set>
        where studentid = #{studentid}
    </update>
    <update id="updateStudentStatus">
        update tbl_student
        <set>
            <if test="studentstatus != '' and studentstatus != null">
                studentstatus = #{studentstatus},
            </if>
        </set>
        where studentid = #{studentid}
    </update>
    <update id="restStudentPwd">
        update tbl_student
        <set>
            <if test="studentpwd != '' and studentpwd != null">
                studentpwd = #{studentpwd},
            </if>
        </set>
        where studentid = #{studentid}
    </update>

    <!--题库-->
    <update id="updateTopic">
        update tbl_safetyvtq
        <set>
            <if test="safetyvtqname != '' and safetyvtqname != null">
                safetyvtqname = #{safetyvtqname},
            </if>
            <if test="a != '' and a != null">
                a = #{a},
            </if>
            <if test="avalue != null">
                avalue = #{avalue},
            </if>
            <if test="b != '' and b != null">
                b = #{b},
            </if>
            <if test="bvalue != null">
                bvalue = #{bvalue},
            </if>
        </set>
        where safetyvtqid = #{safetyvtqid}
    </update>

    <update id="updateSafetyVideo">
        update tbl_safetyvideo
        <set>
            <if test="safetyvideoname != '' and safetyvideoname != null">
                safetyvideoname = #{safetyvideoname},
            </if>
                safetyvideotime = now(),
            <if test="videoname != '' and videoname != null">
                videoname = #{videoname},
            </if>
            <if test="videoadd != '' and videoadd != null">
                videoadd = #{videoadd},
            </if>
        </set>
        where safetyvideoid = #{safetyvideoid}
    </update>
    <update id="updateParameter">
        update tbl_parameter
        <set>
            <if test="parametername != '' and parametername != null">
                parametername = #{parametername},
            </if>
            <if test="parametertype != '' and parametertype != null and parametertype != '请选择'">
                parametertype = #{parametertype},
            </if>
            <if test="parameterval != '' and parameterval != null">
                parameterval = #{parameterval},
            </if>
        </set>
        where parameterid = #{parameterid}
    </update>
    <update id="updateAdminInfo">
        update tbl_admin
        <set>
            <if test="adminsex != '' and adminsex != null">
                adminsex = #{adminsex},
            </if>
            <if test="adminheadurl != '' and adminheadurl != null ">
                adminheadurl = #{adminheadurl},
            </if>
            <if test="adminphone != '' and adminphone != null">
                adminphone = #{adminphone},
            </if>
        </set>
        where adminid = #{adminid}
    </update>
    <update id="updateAdminInfos">
        update tbl_admin
        <set>
            <if test="adminsex != '' and adminsex != null">
                adminsex = #{adminsex},
            </if>
            <if test="adminheadurl != '' and adminheadurl != null ">
                adminheadurl = #{adminheadurl},
            </if>
            <if test="adminphone != '' and adminphone != null">
                adminphone = #{adminphone},
            </if>
            <if test="adminpwd != '' and adminpwd != null">
                adminpwd = #{adminpwd},
            </if>
            <if test="rid != null">
                rid = #{rid},
            </if>
        </set>
        where adminid = #{adminid}
    </update>
    <update id="updateAdminStatus">
        update tbl_admin
        <set>
            <if test="adminstatus != '' and adminstatus != null">
                adminstatus = #{adminstatus},
            </if>
        </set>
        where adminid = #{adminid}
    </update>


    <!--园所信息-->
    <resultMap id="KinderMap" type="com.great.kindergarten.commons.entity.TblKinder">
        <result column="kinderid" property="kinderid"></result>
        <result column="kindername" property="kindername"></result>
        <result column="kinderlp" property="kinderlp"></result>
        <result column="kinderlpid" property="kinderlpid"></result>
        <result column="kinderlpadd" property="kinderlpadd"></result>
        <result column="kinderlpphone" property="kinderlpphone"></result>

        <result column="schoolpermit" property="schoolpermit"></result>
        <result column="healthpermit" property="healthpermit"></result>
        <result column="firepermit" property="firepermit"></result>

        <result column="grouppermit" property="grouppermit"></result>
        <result column="registrationpermit" property="registrationpermit"></result>
        <result column="kinderapptime" property="kinderapptime"></result>
        <result column="kinderregtime" property="kinderregtime"></result>

        <result column="kinderstatus" property="kinderstatus"></result>
        <result column="kinderacount" property="kinderacount"></result>
        <result column="kindercode" property="kindercode"></result>
        <result column="kinderpwd" property="kinderpwd"></result>
        <result column="kinderscale" property="kinderscale"></result>
        <result column="kinderfunds" property="kinderfunds"></result>

        <result column="rectorid" property="rectorid"></result>
        <result column="rectorname" property="rectorname"></result>
        <result column="recid" property="recid"></result>
        <association property="tblRector" javaType="com.great.kindergarten.commons.entity.TblRector">
            <id property="rectorid" column="rectorid"/>
            <result property="rectorid" column="rectorid"/>
            <result property="rectorname" column="rectorname"/>
        </association>
    </resultMap>


    <select id="findAllKinder" resultMap="KinderMap">
        select k.*,r.rectorid,r.rectorname from tbl_kinder k,tbl_rector r
        <where>
            k.recid = r.rectorid

            <if test=" time1 != '' and time1 != null">
                <![CDATA[   and DATE_FORMAT(kinderregtime, '%Y-%m-%d')>=  DATE_FORMAT(#{time1}, '%Y-%m-%d')   ]]>
            </if>
            <if test=" time2 != '' and time2 != null">
                <![CDATA[   and DATE_FORMAT(kinderregtime, '%Y-%m-%d')<=  DATE_FORMAT(#{time2}, '%Y-%m-%d')   ]]>
            </if>
            <if test=" kindername != '' and kindername != null">
                and kindername like concat('%',#{kindername},'%')
            </if>
            <if test=" kinderstatus != '' and kinderstatus != null and kinderstatus !='请选择'">
                and kinderstatus = #{kinderstatus}
            </if>
            <if test=" kindercode != '' and  kindercode != null and kindercode !='请选择'">
                and kindercode = #{kindercode}
            </if>
        </where>
        order by k.kinderregtime desc
    </select>

    <select id="findAllCount" resultType="java.lang.Integer">
        select count(*) from tbl_kinder k,tbl_rector r
        <where>
            k.recid = r.rectorid
            <if test="time1!= '' and time1 != null">
                <![CDATA[   and DATE_FORMAT(kinderregtime, '%Y-%m-%d')>=  DATE_FORMAT(#{time1}, '%Y-%m-%d')   ]]>
            </if>
            <if test="time2!= '' and time2 != null">
                <![CDATA[   and DATE_FORMAT(kinderregtime, '%Y-%m-%d')<=  DATE_FORMAT(#{time2}, '%Y-%m-%d')   ]]>
            </if>
            <if test=" kindername != '' and kindername != null">
                and kindername like concat('%',#{kindername},'%')
            </if>
            <if test=" kinderstatus != '' and  kinderstatus != null and kinderstatus !='请选择'">
                and kinderstatus = #{kinderstatus}
            </if>
            <if test=" kindercode != '' and  kindercode != null and kindercode !='请选择'">
                and kindercode = #{kindercode}
            </if>
        </where>
    </select>

    <!--园所详情信息-->
    <select id="findKinderInfoById" resultMap="KinderMap" >
        select k.*,r.rectorid,r.rectorname from tbl_kinder k,tbl_rector r
        <where>
            k.recid = r.rectorid and k.kinderid = #{k.kinderid}
        </where>
    </select>

    <select id="findTblKinderById" resultType="com.great.kindergarten.commons.entity.TblKinder">
        select * from tbl_kinder where kinderid = #{kinderid}
    </select>

    <select id="findKinder" resultType="com.great.kindergarten.commons.entity.TblKinder">
        select * from tbl_kinder
    </select>

    <select id="findAccountByName" resultType="java.lang.String">
        select kinderacount from tbl_kinder where kindername = #{kindername}
    </select>

    <select id="initialPwd" resultType="java.lang.String">
        select parameterval from tbl_parameter where parametername = #{parametername}
    </select>

    <select id="findAllParameter" resultType="com.great.kindergarten.commons.entity.TblParameter">
        select * from tbl_parameter
        <where>
            <if test=" parametername != '' and parametername != null">
                and parametername like concat('%',#{parametername},'%')
            </if>
            <if test=" parametertype != '' and parametertype != null and parametertype !='请选择'">
                and parametertype = #{parametertype}
            </if>
        </where>
        order by parametertype asc
    </select>
    <select id="findParameterCount" resultType="java.lang.Integer">
        select count(*) from tbl_parameter
        <where>
            <if test=" parametername != '' and parametername != null">
                and parametername like concat('%',#{parametername},'%')
            </if>
            <if test=" parametertype != '' and parametertype != null and parametertype !='请选择'">
                and parametertype = #{parametertype}
            </if>
        </where>
        order by parametertype asc
    </select>
    <select id="findParameterInfo" resultType="com.great.kindergarten.commons.entity.TblParameter">
        select * from tbl_parameter;
    </select>
    <select id="findStairMenu" resultType="com.great.kindergarten.commons.entity.TblMenu">
        select * from tbl_menu where menusonid = 0
    </select>

    <select id="findAllMenu" resultType="com.great.kindergarten.commons.entity.TblMenu">
        select * from tbl_menu
        <where>
            <if test=" mName != '' and mName != null">
                and menuname like concat('%',#{mName},'%')
            </if>
            <if test=" pName != '' and pName != null and pName !='请选择'">
                and menuname = #{pName}
            </if>
        </where>
        order by menuname asc
    </select>

    <select id="findMenuCount" resultType="java.lang.Integer">
        select count(*) from tbl_menu
        <where>
            <if test=" mName != '' and mName != null">
                and menuname like concat('%',#{mName},'%')
            </if>
            <if test=" pName != '' and pName != null and pName !='请选择'">
                and menuname = #{pName}
            </if>
        </where>
        order by menuname asc
    </select>


    <select id="findSuperierMenu" resultType="java.lang.String">
        select menuname from tbl_menu where menuid in (
            select menusonid from tbl_menu where menuid = #{menuid}
        )
    </select>
    <select id="findSidByName" resultType="java.lang.Integer">
        select menuid from tbl_menu where menuname = #{menuname}
    </select>
    <select id="findRoleMenuIdByMid" resultType="java.lang.Integer">
        select rolemenuid from tbl_rolemenu where mid = #{mid}
    </select>
    <select id="findSidByMid" resultType="java.lang.Integer">
        select menusonid from tbl_menu where menuid = #{menuid}
    </select>

    <select id="findAllRoleInfo" resultType="com.great.kindergarten.commons.entity.TblRole">
        select * from tbl_role
        <where>
            <if test="rolename != '' and rolename != null and rolename != '请选择'">
                and rolename = #{rolename}
            </if>
        </where>
    </select>

    <select id="findRoleCount" resultType="java.lang.Integer">
        select count(*) from tbl_role
        <where>
            <if test="rolename != '' and rolename != null and rolename != '请选择'">
                and rolename = #{rolename}
            </if>
        </where>
    </select>

    <select id="findAllRoleName" resultType="java.lang.String">
        select rolename from tbl_role
    </select>
    <select id="findRoleMenuIdByRid" resultType="com.great.kindergarten.commons.entity.TblRoleMenu">
        select t2.rolemenuid from tbl_role t1,tbl_rolemenu t2 where t1.roleid = t2.rid
    </select>
    <select id="checkRoleName" resultType="java.lang.Integer">
        select roleid from tbl_role where rolename = #{rolename}
    </select>
    <select id="checkMenuName" resultType="java.lang.Integer">
        select menuid from tbl_menu where menuname = #{menuname}
    </select>

    <!--    亲子阅读-->
    <select id="findAllReadInfo" resultType="com.great.kindergarten.commons.entity.TblReadmag">
        select * from tbl_readmag
        <where>
            readmagpage = 0
            <if test=" time1 != '' and time1 != null">
                <![CDATA[   and DATE_FORMAT(readmagtime, '%Y-%m-%d')>=  DATE_FORMAT(#{time1}, '%Y-%m-%d')   ]]>
            </if>
            <if test=" time2 != '' and time2 != null">
                <![CDATA[   and DATE_FORMAT(readmagtime, '%Y-%m-%d')<=  DATE_FORMAT(#{time2}, '%Y-%m-%d')   ]]>
            </if>
            <if test=" readmagname != '' and readmagname != null">
                and readmagname like concat('%',#{readmagname},'%')
            </if>
        </where>
        order by readmagtime desc
    </select>
    <select id="findReadCount" resultType="java.lang.Integer">
        select count(*) from tbl_readmag
        <where>
            readmagpage = 0
            <if test=" time1 != '' and time1 != null">
                <![CDATA[   and DATE_FORMAT(readmagtime, '%Y-%m-%d')>=  DATE_FORMAT(#{time1}, '%Y-%m-%d')   ]]>
            </if>
            <if test=" time2 != '' and time2 != null">
                <![CDATA[   and DATE_FORMAT(readmagtime, '%Y-%m-%d')<=  DATE_FORMAT(#{time2}, '%Y-%m-%d')   ]]>
            </if>
            <if test=" readmagname != '' and readmagname != null">
                and readmagname like concat('%',#{readmagname},'%')
            </if>
        </where>
    </select>

    <select id="findReadInfoById" resultType="com.great.kindergarten.commons.entity.TblReadmag">
        select * from tbl_readmag
        <where>
            relatedid=#{readmagid}

        </where>
        order by readmagpage asc limit #{curPage},#{pageSize}
    </select>
    <select id="findReadCountById" resultType="java.lang.Integer">
        select count(*) from tbl_readmag
        <where>
            relatedid=#{readmagid}
            and readmagpage != 0
        </where>
    </select>

    <select id="findRoleInfo" resultType="com.great.kindergarten.commons.entity.TblRole">
        select roleid, rolename from tbl_role where rolename like '%管理员%';
    </select>
    <select id="findMenuByRid" resultType="com.great.kindergarten.commons.entity.TblMenu">
        select *
		from tbl_menu
		where menuid in (
			select mid
			from tbl_rolemenu R1
			where R1.rid in
				  (select R.roleid
				   from tbl_role R
							left join tbl_admin A on R.roleid = A.rid
				   where R.roleid = #{roleid} and menusonid = 0)
				   )
    </select>
    <select id="findAllPlatFormInfo" resultType="com.great.kindergarten.commons.entity.TblPlatforminfo">
        select * from tbl_platforminfo
        <where>
            <if test=" time1 != '' and time1 != null">
                <![CDATA[   and DATE_FORMAT(platforminfotime, '%Y-%m-%d')>=  DATE_FORMAT(#{time1}, '%Y-%m-%d')   ]]>
            </if>
            <if test=" time2 != '' and time2 != null">
                <![CDATA[   and DATE_FORMAT(platforminfotime, '%Y-%m-%d')<=  DATE_FORMAT(#{time2}, '%Y-%m-%d')   ]]>
            </if>
            <if test=" platforminfoname != '' and platforminfoname != null">
                and platforminfoname like concat('%',#{platforminfoname},'%')
            </if>
        </where>
        order by platforminfotime asc
    </select>
    <select id="findPlatFormInfoCount" resultType="java.lang.Integer">
        select count(*) from tbl_platforminfo
        <where>
            <if test=" time1 != '' and time1 != null">
                <![CDATA[   and DATE_FORMAT(platforminfotime, '%Y-%m-%d')>=  DATE_FORMAT(#{time1}, '%Y-%m-%d')   ]]>
            </if>
            <if test=" time2 != '' and time2 != null">
                <![CDATA[   and DATE_FORMAT(platforminfotime, '%Y-%m-%d')<=  DATE_FORMAT(#{time2}, '%Y-%m-%d')   ]]>
            </if>
            <if test=" platforminfoname != '' and platforminfoname != null">
                and platforminfoname like concat('%',#{platforminfoname},'%')
            </if>
        </where>
        order by platforminfotime asc
    </select>


    <!--园长管理-->
    <resultMap id="RectorMap" type="com.great.kindergarten.admin.javabean.RectorKinderBean">
        <result column="rectorid" property="rectorid"></result>
        <result column="rectorname" property="rectorname"></result>
        <result column="rectorpwd" property="rectorpwd"></result>
        <result column="rectorsex" property="rectorsex"></result>
        <result column="rectorage" property="rectorage"></result>
        <result column="rectoradd" property="rectoradd"></result>
        <result column="rectorphone" property="rectorphone"></result>
        <result column="rectorregtime" property="rectorregtime"></result>
        <result column="rectorstatus" property="rectorstatus"></result>
        <result column="kinderid" property="kinderid"></result>
        <result column="kindername" property="kindername"></result>
        <result column="recid" property="recid"></result>
        <association property="tblKinder" javaType="com.great.kindergarten.commons.entity.TblKinder">
            <id property="kinderid" column="kinderid"/>
            <result property="kinderid" column="kinderid"/>
            <result property="kindername" column="kindername"/>
        </association>
    </resultMap>

    <select id="findAllRectorInfo" resultMap="RectorMap">
        select r.*,k.kinderid,k.kindername from tbl_rector r,tbl_kinder k
        <where>
            r.rectorid = k.recid
            <if test=" time1 != '' and time1 != null">
                <![CDATA[   and DATE_FORMAT(rectorregtime, '%Y-%m-%d')>=  DATE_FORMAT(#{time1}, '%Y-%m-%d')   ]]>
            </if>
            <if test=" time2 != '' and time2 != null">
                <![CDATA[   and DATE_FORMAT(rectorregtime, '%Y-%m-%d')<=  DATE_FORMAT(#{time2}, '%Y-%m-%d')   ]]>
            </if>
            <if test=" rectorname != '' and rectorname != null ">
                and rectorname like concat('%',#{rectorname},'%')
            </if>
            <if test=" rectorstatus != '' and rectorstatus != null and rectorstatus != '请选择'">
                and rectorstatus = #{rectorstatus}
            </if>
            <if test=" kindername != '' and kindername != null and kindername != '请选择'">
                and kindername = #{kindername}
            </if>
        </where>
        order by r.rectorregtime desc
    </select>
    <select id="findRectorInfoCount" resultType="java.lang.Integer">
        select count(*) from tbl_rector r,tbl_kinder k
        <where>
            r.rectorid = k.recid
            <if test=" time1 != '' and time1 != null">
                <![CDATA[   and DATE_FORMAT(rectorregtime, '%Y-%m-%d')>=  DATE_FORMAT(#{time1}, '%Y-%m-%d')   ]]>
            </if>
            <if test=" time2 != '' and time2 != null">
                <![CDATA[   and DATE_FORMAT(rectorregtime, '%Y-%m-%d')<=  DATE_FORMAT(#{time2}, '%Y-%m-%d')   ]]>
            </if>
            <if test=" rectorname != '' and rectorname != null">
                and rectorname like concat('%',#{rectorname},'%')
            </if>
            <if test=" rectorstatus != '' and rectorstatus != null and rectorstatus != '请选择'">
                and rectorstatus = #{rectorstatus}
            </if>
            <if test=" kindername != '' and kindername != null and kindername != '请选择'">
                and kindername = #{kindername}
            </if>
        </where>
        order by r.rectorregtime desc
    </select>


    <!--查找教师信息表-->
    <resultMap id="TeacherMap" type="com.great.kindergarten.commons.entity.TblTeacher">
        <result column="teacherid" property="teacherid"></result>
        <result column="teachername" property="teachername"></result>
        <result column="teacherpwd" property="teacherpwd"></result>
        <result column="teachersex" property="teachersex"></result>
        <result column="teacherage" property="teacherage"></result>
        <result column="teacheradd" property="teacheradd"></result>
        <result column="teacherphone" property="teacherphone"></result>
        <result column="teacherjob" property="teacherjob"></result>
        <result column="teacherregtime" property="teacherregtime"></result>
        <result column="teacherstatus" property="teacherstatus"></result>
        <result column="classid" property="classid"></result>
        <result column="classname" property="classname"></result>
        <result column="cid" property="cid"></result>
        <association property="tblClass" javaType="com.great.kindergarten.commons.entity.TblClass">
            <id property="classid" column="classid"/>
            <result property="classid" column="classid"/>
            <result property="classname" column="classname"/>
        </association>
    </resultMap>

    <select id="findAllTeacherInfo" resultMap="TeacherMap" parameterType="com.great.kindergarten.commons.entity.TblTeacher">
        select c.classid,c.classname,e.*
        from tbl_teacher e,tbl_class c
        <where>
            e.cid = c.classid
            <if test=" time1 != '' and time1 != null">
                <![CDATA[   and DATE_FORMAT(teacherregtime, '%Y-%m-%d')>=  DATE_FORMAT(#{time1}, '%Y-%m-%d')   ]]>
            </if>
            <if test=" time2 != '' and time2 != null">
                <![CDATA[   and DATE_FORMAT(teacherregtime, '%Y-%m-%d')<=  DATE_FORMAT(#{time2}, '%Y-%m-%d')   ]]>
            </if>
            <if test=" teachername != '' and teachername != null ">
                and teachername like concat('%',#{teachername},'%')
            </if>
            <if test=" teacherstatus != '' and teacherstatus != null and teacherstatus != '请选择'">
                and teacherstatus = #{teacherstatus}
            </if>
            <if test=" teacherjob != '' and teacherjob != null and teacherjob != '请选择'">
                and teacherjob = #{teacherjob}
            </if>
        </where>
        order by e.teacherregtime desc
    </select>

    <select id="findTeacherInfoCount" resultType="java.lang.Integer">
        select count(*)
        from tbl_teacher e,tbl_class c
        <where>
            e.cid = c.classid
            <if test=" time1 != '' and time1 != null">
                <![CDATA[   and DATE_FORMAT(teacherregtime, '%Y-%m-%d')>=  DATE_FORMAT(#{time1}, '%Y-%m-%d')   ]]>
            </if>
            <if test=" time2 != '' and time2 != null">
                <![CDATA[   and DATE_FORMAT(teacherregtime, '%Y-%m-%d')<=  DATE_FORMAT(#{time2}, '%Y-%m-%d')   ]]>
            </if>
            <if test=" teachername != '' and teachername != null ">
                and teachername like concat('%',#{teachername},'%')
            </if>
            <if test=" teacherstatus != '' and teacherstatus != null and teacherstatus != '请选择'">
                and teacherstatus = #{teacherstatus}
            </if>
            <if test=" teacherjob != '' and teacherjob != null and teacherjob != '请选择'">
                and teacherjob = #{teacherjob}
            </if>
        </where>
        order by e.teacherregtime desc
    </select>
    <select id="findAllJob" resultType="java.lang.String">
        select teacherjob from tbl_teacher;
    </select>


    <!--家长管理-->
    <select id="findAllParentInfo" resultType="com.great.kindergarten.commons.entity.TblParent">
        select * from tbl_parent
        <where>
            <if test=" time1 != '' and time1 != null">
                <![CDATA[   and DATE_FORMAT(parentRegTime, '%Y-%m-%d')>=  DATE_FORMAT(#{time1}, '%Y-%m-%d')   ]]>
            </if>
            <if test=" time2 != '' and time2 != null">
                <![CDATA[   and DATE_FORMAT(parentRegTime, '%Y-%m-%d')<=  DATE_FORMAT(#{time2}, '%Y-%m-%d')   ]]>
            </if>
            <if test=" parentName != '' and parentName != null ">
                and parentName like concat('%',#{parentName},'%')
            </if>
            <if test=" parentStatus != '' and parentStatus != null and parentStatus != '请选择'">
                and parentStatus = #{parentStatus}
            </if>
            <if test=" parentJob != '' and parentJob != null and parentJob != '请选择'">
                and parentjob = #{parentJob}
            </if>
        </where>
        order by parentRegTime desc
    </select>
    <select id="findParentInfoCount" resultType="java.lang.Integer">
        select count(*) from tbl_parent
        <where>
            <if test=" time1 != '' and time1 != null">
                <![CDATA[   and DATE_FORMAT(parentRegTime, '%Y-%m-%d')>=  DATE_FORMAT(#{time1}, '%Y-%m-%d')   ]]>
            </if>
            <if test=" time2 != '' and time2 != null">
                <![CDATA[   and DATE_FORMAT(parentRegTime, '%Y-%m-%d')<=  DATE_FORMAT(#{time2}, '%Y-%m-%d')   ]]>
            </if>
            <if test=" parentName != '' and parentName != null ">
                and parentName like concat('%',#{parentName},'%')
            </if>
            <if test=" parentStatus != '' and parentStatus != null and parentStatus != '请选择'">
                and parentStatus = #{parentStatus}
            </if>
        </where>
        order by parentRegTime desc
    </select>
    <select id="findParentJob" resultType="java.lang.String">
        select parentjob from tbl_parent;
    </select>


    <!--    保健员管理-->
    <resultMap id="HealtherMap" type="com.great.kindergarten.commons.entity.TblHealther">
        <result column="healtherid" property="healtherid"></result>
        <result column="healthername" property="healthername"></result>
        <result column="healtherpwd" property="healtherpwd"></result>
        <result column="healthersex" property="healthersex"></result>
        <result column="healtherage" property="healtherage"></result>
        <result column="healtheradd" property="healtheradd"></result>
        <result column="healtherphone" property="healtherphone"></result>
        <result column="healtherregtime" property="healtherregtime"></result>
        <result column="healtherstatus" property="healtherstatus"></result>
        <result column="kinderid" property="kinderid"></result>
        <result column="kindername" property="kindername"></result>
        <result column="kid" property="kid"></result>
        <association property="tblKinder" javaType="com.great.kindergarten.commons.entity.TblKinder">
            <id property="kinderid" column="kinderid"/>
            <result property="kinderid" column="kinderid"/>
            <result property="kindername" column="kindername"/>
        </association>
    </resultMap>


    <select id="findAllHealtherInfo" resultMap="HealtherMap" >
        select h.*,k.kinderid,k.kindername from tbl_healther h,tbl_kinder k
        <where>
            h.kid = k.kinderid
            <if test=" time1 != '' and time1 != null">
                <![CDATA[   and DATE_FORMAT(healtherregtime, '%Y-%m-%d')>=  DATE_FORMAT(#{time1}, '%Y-%m-%d')   ]]>
            </if>
            <if test=" time2 != '' and time2 != null">
                <![CDATA[   and DATE_FORMAT(healtherregtime, '%Y-%m-%d')<=  DATE_FORMAT(#{time2}, '%Y-%m-%d')   ]]>
            </if>
            <if test=" healthername != '' and healthername != null ">
                and healthername like concat('%',#{healthername},'%')
            </if>
            <if test=" healtherstatus != '' and healtherstatus != null and healtherstatus != '请选择'">
                and healtherstatus = #{healtherstatus}
            </if>
            <if test=" kindername != '' and kindername != null and kindername != '请选择'">
                and kindername = #{kindername}
            </if>
        </where>
        order by h.healtherregtime desc
    </select>

    <select id="findHealtherInfoCount" resultType="java.lang.Integer">
        select count(*) from tbl_healther h,tbl_kinder k
        <where>
            h.kid = k.kinderid
            <if test=" time1 != '' and time1 != null">
                <![CDATA[   and DATE_FORMAT(healtherregtime, '%Y-%m-%d')>=  DATE_FORMAT(#{time1}, '%Y-%m-%d')   ]]>
            </if>
            <if test=" time2 != '' and time2 != null">
                <![CDATA[   and DATE_FORMAT(healtherregtime, '%Y-%m-%d')<=  DATE_FORMAT(#{time2}, '%Y-%m-%d')   ]]>
            </if>
            <if test=" healthername != '' and healthername != null ">
                and healthername like concat('%',#{healthername},'%')
            </if>
            <if test=" healtherstatus != '' and healtherstatus != null and healtherstatus != '请选择'">
                and healtherstatus = #{healtherstatus}
            </if>
            <if test=" kindername != '' and kindername != null and kindername != '请选择'">
                and kindername = #{kindername}
            </if>
        </where>
        order by h.healtherregtime desc
    </select>



    <!--    安防员管理-->
    <resultMap id="SecurityMap" type="com.great.kindergarten.commons.entity.TblSecurity">
        <result column="securityid" property="securityid"></result>
        <result column="securityname" property="securityname"></result>
        <result column="securitypwd" property="securitypwd"></result>
        <result column="securitysex" property="securitysex"></result>
        <result column="securityage" property="securityage"></result>
        <result column="securityadd" property="securityadd"></result>
        <result column="securityphone" property="securityphone"></result>
        <result column="securityregtime" property="securityregtime"></result>
        <result column="securitystatus" property="securitystatus"></result>
        <result column="kinderid" property="kinderid"></result>
        <result column="kindername" property="kindername"></result>
        <result column="kid" property="kid"></result>
        <association property="tblKinder" javaType="com.great.kindergarten.commons.entity.TblKinder">
            <id property="kinderid" column="kinderid"/>
            <result property="kinderid" column="kinderid"/>
            <result property="kindername" column="kindername"/>
        </association>
    </resultMap>


    <select id="findAllSecurityInfo" resultMap="SecurityMap">
        select s.*,k.kinderid,k.kindername from tbl_security s,tbl_kinder k
        <where>
            s.kid = k.kinderid
            <if test=" time1 != '' and time1 != null">
                <![CDATA[   and DATE_FORMAT(securityregtime, '%Y-%m-%d')>=  DATE_FORMAT(#{time1}, '%Y-%m-%d')   ]]>
            </if>
            <if test=" time2 != '' and time2 != null">
                <![CDATA[   and DATE_FORMAT(securityregtime, '%Y-%m-%d')<=  DATE_FORMAT(#{time2}, '%Y-%m-%d')   ]]>
            </if>
            <if test=" securityname != '' and securityname != null ">
                and securityname like concat('%',#{securityname},'%')
            </if>
            <if test=" securitystatus != '' and securitystatus != null and securitystatus != '请选择'">
                and securitystatus = #{securitystatus}
            </if>
            <if test=" kindername != '' and kindername != null and kindername != '请选择'">
                and kindername = #{kindername}
            </if>
        </where>
        order by s.securityregtime desc
    </select>

    <select id="findSecurityInfoCount" resultType="java.lang.Integer">
        select count(*) from tbl_security s,tbl_kinder k
        <where>
            s.kid = k.kinderid
            <if test=" time1 != '' and time1 != null">
                <![CDATA[   and DATE_FORMAT(securityregtime, '%Y-%m-%d')>=  DATE_FORMAT(#{time1}, '%Y-%m-%d')   ]]>
            </if>
            <if test=" time2 != '' and time2 != null">
                <![CDATA[   and DATE_FORMAT(securityregtime, '%Y-%m-%d')<=  DATE_FORMAT(#{time2}, '%Y-%m-%d')   ]]>
            </if>
            <if test=" securityname != '' and securityname != null ">
                and securityname like concat('%',#{securityname},'%')
            </if>
            <if test=" securitystatus != '' and securitystatus != null and securitystatus != '请选择'">
                and securitystatus = #{securitystatus}
            </if>
            <if test=" kindername != '' and kindername != null and kindername != '请选择'">
                and kindername = #{kindername}
            </if>
        </where>
        order by s.securityregtime desc
    </select>


    <!--查找学生信息表-->
    <resultMap id="StudentMap" type="com.great.kindergarten.commons.entity.TblStudent">
        <result column="studentid" property="studentid"></result>
        <result column="studentname" property="studentname"></result>
        <result column="studentpwd" property="studentpwd"></result>
        <result column="studentsex" property="studentsex"></result>
        <result column="studentadd" property="studentadd"></result>
        <result column="studentbirth" property="studentbrith"></result>
        <result column="studenttime" property="studenttime"></result>
        <result column="studentstatus" property="studentstatus"></result>
        <result column="classid" property="classid"></result>
        <result column="classname" property="classname"></result>
        <result column="kinderid" property="kinderid"></result>
        <result column="kindername" property="kindername"></result>
        <result column="parentId" property="parentId"></result>
        <result column="parentName" property="parentName"></result>
        <result column="kid" property="kid"></result>
        <result column="pid" property="pid"></result>
        <result column="cid" property="cid"></result>
        <association property="tblClass" javaType="com.great.kindergarten.commons.entity.TblClass">
            <id property="classid" column="classid"/>
            <result property="classid" column="classid"/>
            <result property="classname" column="classname"/>
        </association>
        <association property="tblKinder" javaType="com.great.kindergarten.commons.entity.TblKinder">
            <id property="kinderid" column="kinderid"/>
            <result property="kinderid" column="kinderid"/>
            <result property="kindername" column="kindername"/>
        </association>
        <association property="tblParent" javaType="com.great.kindergarten.commons.entity.TblParent">
            <id property="parentId" column="parentId"/>
            <result property="parentId" column="parentId"/>
            <result property="parentName" column="parentName"/>
        </association>
    </resultMap>


    <select id="findAllStudentInfo" resultMap="StudentMap" parameterType="com.great.kindergarten.commons.entity.TblStudent">
        select c.classid,c.classname,k.kinderid,k.kindername,p.parentId,p.parentName,s.*
        from tbl_student s,tbl_kinder k,tbl_class c,tbl_parent p
        <where>
            s.cid = c.classid and s.kid = k.kinderid and s.pid = p.parentId
            <if test=" time1 != '' and time1 != null">
                <![CDATA[   and DATE_FORMAT(studenttime, '%Y-%m-%d')>=  DATE_FORMAT(#{time1}, '%Y-%m-%d')   ]]>
            </if>
            <if test=" time2 != '' and time2 != null">
                <![CDATA[   and DATE_FORMAT(studenttime, '%Y-%m-%d')<=  DATE_FORMAT(#{time2}, '%Y-%m-%d')   ]]>
            </if>
            <if test=" studentname != '' and studentname != null ">
                and studentname like concat('%',#{studentname},'%')
            </if>
            <if test=" studentstatus != '' and studentstatus != null and studentstatus != '请选择'">
                and studentstatus = #{studentstatus}
            </if>
        </where>
        order by s.studenttime desc
    </select>

    <select id="findStudentInfoCount" resultType="java.lang.Integer">
        select count(*)
        from tbl_student s,tbl_kinder k,tbl_class c,tbl_parent p
        <where>
            s.cid = c.classid and s.kid = k.kinderid and s.pid = p.parentId
            <if test=" time1 != '' and time1 != null">
                <![CDATA[   and DATE_FORMAT(studenttime, '%Y-%m-%d')>=  DATE_FORMAT(#{time1}, '%Y-%m-%d')   ]]>
            </if>
            <if test=" time2 != '' and time2 != null">
                <![CDATA[   and DATE_FORMAT(studenttime, '%Y-%m-%d')<=  DATE_FORMAT(#{time2}, '%Y-%m-%d')   ]]>
            </if>
            <if test=" studentname != '' and studentname != null ">
                and studentname like concat('%',#{studentname},'%')
            </if>
            <if test=" studentstatus != '' and studentstatus != null and studentstatus != '请选择'">
                and studentstatus = #{studentstatus}
            </if>
        </where>
        order by s.studenttime desc
    </select>

<!--    安全教育管理-->
    <resultMap id="VideoMap" type="com.great.kindergarten.commons.entity.TblSafetyvideo">
        <result column="safetyvideoid" property="safetyvideoid"></result>
        <result column="safetyvideoname" property="safetyvideoname"></result>
        <result column="safetyvideotime" property="safetyvideotime"></result>
        <result column="videoname" property="videoname"></result>
        <result column="videoadd" property="videoadd"></result>
        <result column="monitornameid" property="monitornameid"></result>
        <result column="monitorname" property="monitorname"></result>
        <result column="mid" property="mid"></result>
        <association property="tblMonitorname" javaType="com.great.kindergarten.commons.entity.TblMonitorname">
            <id property="monitornameid" column="monitornameid"/>
            <result property="monitornameid" column="monitornameid"/>
            <result property="monitorname" column="monitorname"/>
        </association>
    </resultMap>

    <select id="findAllSafetyVideoInfo" resultMap="VideoMap" parameterType="com.great.kindergarten.commons.entity.TblSafetyvideo">
        select m.monitornameid,m.monitorname,s.*
            from tbl_safetyvideo s,tbl_monitorname m
            <where>
                s.mid = m.monitornameid
                <if test=" time1 != '' and time1 != null">
                    <![CDATA[   and DATE_FORMAT(safetyvideotime, '%Y-%m-%d')>=  DATE_FORMAT(#{time1}, '%Y-%m-%d')   ]]>
                </if>
                <if test=" time2 != '' and time2 != null">
                    <![CDATA[   and DATE_FORMAT(safetyvideotime, '%Y-%m-%d')<=  DATE_FORMAT(#{time2}, '%Y-%m-%d')   ]]>
                </if>
                <if test=" safetyvideoname != '' and safetyvideoname != null ">
                    and safetyvideoname like concat('%',#{safetyvideoname},'%')
                </if>
            </where>
            order by s.safetyvideotime asc
    </select>

    <select id="findSafetyVideoInfoCount" resultType="java.lang.Integer">
        select count(*)
            from tbl_safetyvideo s,tbl_monitorname m
            <where>
                s.mid = m.monitornameid
                <if test=" time1 != '' and time1 != null">
                    <![CDATA[   and DATE_FORMAT(safetyvideotime, '%Y-%m-%d')>=  DATE_FORMAT(#{time1}, '%Y-%m-%d')   ]]>
                </if>
                <if test=" time2 != '' and time2 != null">
                    <![CDATA[   and DATE_FORMAT(safetyvideotime, '%Y-%m-%d')<=  DATE_FORMAT(#{time2}, '%Y-%m-%d')   ]]>
                </if>
                <if test=" safetyvideoname != '' and safetyvideoname != null ">
                    and safetyvideoname like concat('%',#{safetyvideoname},'%')
                </if>
            </where>
            order by s.safetyvideotime asc
    </select>

    <select id="findAllSafetyVideoItemsInfo" resultType="com.great.kindergarten.commons.entity.TblSafetyvtq" parameterType="com.great.kindergarten.commons.entity.TblSafetyvtq">
        select s2.safetyvideoid,s2.safetyvideoname as safetyvideoname,s1.*
        from tbl_safetyvtq s1,tbl_safetyvideo s2
        <where>
            s1.safetyvideoid = s2.safetyvideoid and s2.safetyvideoid = #{safetyvideoid}
        </where>
    </select>

<!--    试题配置-->
    <select id="findAllVideoQuestionConfigInfo" resultMap="VideoMap">
        select m.monitornameid,m.monitorname,s.*
            from tbl_safetyvideo s,tbl_monitorname m
            <where>
                s.mid = m.monitornameid
                <if test=" time1 != '' and time1 != null">
                    <![CDATA[   and DATE_FORMAT(safetyvideotime, '%Y-%m-%d')>=  DATE_FORMAT(#{time1}, '%Y-%m-%d')   ]]>
                </if>
                <if test=" time2 != '' and time2 != null">
                    <![CDATA[   and DATE_FORMAT(safetyvideotime, '%Y-%m-%d')<=  DATE_FORMAT(#{time2}, '%Y-%m-%d')   ]]>
                </if>
                <if test=" safetyvideoname != '' and safetyvideoname != null ">
                    and safetyvideoname like concat('%',#{safetyvideoname},'%')
                </if>
            </where>
            order by s.safetyvideotime desc
    </select>

    <select id="queryTopicById" resultType="com.great.kindergarten.commons.entity.TblSafetyvtq">
        select * from tbl_safetyvtq where safetyvtqid = #{safetyvtqid}
    </select>
    <select id="findAllParameterType" resultType="java.lang.String">
        select parametertype from tbl_parameter;
    </select>

<!--    幼儿统计-->
    <resultMap id="ChildrenStatisticsMap" type="com.great.kindergarten.commons.entity.TblExamination">
        <result column="healthstatus" property="healthstatus"></result>
        <result column="examinationtime" property="examinationtime"></result>
        <result column="studentid" property="studentid"></result>
        <result column="studentname" property="studentname"></result>
        <result column="sid" property="sid"></result>
        <association property="tblStudent" javaType="com.great.kindergarten.commons.entity.TblStudent">
            <id property="studentid" column="studentid"/>
            <result property="studentid" column="studentid"/>
            <result property="studentname" column="studentname"/>
            <result property="studentsex" column="studentsex"/>
            <result property="studentbrith" column="studentbrith"/>
        </association>
    </resultMap>

    <select id="findChildrenStatisticsInfo" resultMap="ChildrenStatisticsMap" parameterType="com.great.kindergarten.commons.entity.TblExamination">
        select s.studentsex,s.studentname,s.studentbrith,e.healthstatus,e.examinationtime
            from tbl_examination e,tbl_student s
            <where>
                e.sid = s.studentid
            </where>
            group by s.studentname,s.studentsex,s.studentbrith,e.healthstatus,e.examinationtime
    </select>

    <select id="findChildrenMaleInfo" parameterType="com.great.kindergarten.commons.entity.TblExamination"
            resultType="com.great.kindergarten.admin.javabean.TblStatistics">
        select date_format(e.examinationtime, '%Y-%m-%d') as time,count(s.studentsex) as maleCount from tbl_student s,tbl_examination e
            <where>
                s.studentid = e.sid and s.studentsex = '男'
            </where>
            group by time
    </select>
    <select id="findChildrenFeMaleInfo" resultType="com.great.kindergarten.admin.javabean.TblStatistics">
        select date_format(e.examinationtime, '%Y-%m-%d') as time,count(s.studentsex) as feMaleCount from tbl_student s,tbl_examination e
        <where>
            s.studentid = e.sid and s.studentsex = '女'
        </where>
        group by time
    </select>
    <select id="findChildrenAAgeInfo" resultType="com.great.kindergarten.admin.javabean.TblStatistics">
        select TIMESTAMPDIFF(YEAR,studentbrith,CURDATE()) AS age,
            date_format(e.examinationtime, '%Y-%m-%d') as time,
            count(s.studentbrith) aCount
            from tbl_student s, tbl_examination e
        <where>
            s.studentid = e.sid
        </where>
            group by time,age having age &lt; 3
    </select>

    <select id="findChildrenBAgeInfo" resultType="com.great.kindergarten.admin.javabean.TblStatistics">
        select TIMESTAMPDIFF(YEAR,studentbrith,CURDATE()) AS age,
            date_format(e.examinationtime, '%Y-%m-%d') as time,
            count(s.studentbrith) bCount
            from tbl_student s, tbl_examination e
            <where>
                s.studentid = e.sid
            </where>
        group by time,age having age &gt;= 3 and age &lt;= 4
    </select>

    <select id="findChildrenCAgeInfo" resultType="com.great.kindergarten.admin.javabean.TblStatistics">
        select TIMESTAMPDIFF(YEAR,studentbrith,CURDATE()) AS age,
            date_format(e.examinationtime, '%Y-%m-%d') as time,
            count(s.studentbrith) cCount
            from tbl_student s, tbl_examination e
            <where>
                s.studentid = e.sid
            </where>
        group by time,age having age &gt; 4 and age &lt;= 6
    </select>

    <select id="findChildrenAgeInfo" resultType="com.great.kindergarten.admin.javabean.TblStatistics">
      select TIMESTAMPDIFF(YEAR,studentbrith,CURDATE()) AS age,date_format(e.examinationtime,'%Y-%m-%d') as time,count(s.studentbrith) aCount
        from tbl_student s, tbl_examination e
        where s.studentid = e.sid
        group by time,age;
    </select>

    <select id="findChildrenStatusInfo" resultType="com.great.kindergarten.admin.javabean.TblStatistics">
        select date_format(e.examinationtime,'%Y-%m-%d') as time,
        e.healthstatus,
        count(e.healthstatus) normalCount
        from tbl_student s, tbl_examination e
        <where>
            s.studentid = e.sid
        </where>
        group by time,e.healthstatus;
    </select>

    <select id="findTSexInfo" resultType="com.great.kindergarten.admin.javabean.TblStatistics">
        select date_format(teacherregtime, '%Y-%m-%d') as time,
            count(teachersex) as maleCount,teachersex
            from tbl_teacher
        group by time,teachersex
    </select>
    <select id="findTAgeInfo" resultType="com.great.kindergarten.admin.javabean.TblStatistics">
        select date_format(teacherregtime, '%Y-%m-%d') as time,
            count(teacherage) as aCount,teacherage
            from tbl_teacher
        group by time,teacherage
    </select>

    <!--    权限-->
    <select id="findAllMenuInfo" resultMap="TreeMap1">
       select * from tbl_menu where menusonid = 0
    </select>

    <resultMap type="com.great.kindergarten.admin.javabean.MenuTreeInfo" id="TreeMap1">
        <result column="menuname" property="title"></result>
        <result column="menuid" property="id"></result>
        <collection property="children" select="sonMenuByMid" column="menuid" ofType="com.great.kindergarten.admin.javabean.MenuTreeInfo"
                    javaType="list">
            <result column="menuname" property="title"/>
            <result column="menuid" property="id"/>
        </collection>
    </resultMap>

    <!--根据父id查找到对应的子id -->
    <select id="sonMenuByMid" resultMap="Tree1" parameterType="java.lang.Integer">
		select * from tbl_menu where menusonid = #{menuid};
    </select>

    <resultMap type="com.great.kindergarten.admin.javabean.MenuTreeInfo" id="Tree1">
        <result column="menuname" property="title"></result>
        <result column="menuid" property="id"></result>
    </resultMap>

    <!--    根据角色id查找出他所对应的菜单id-->
    <select id="findMenuByRoleID" resultMap="TreeMap2" parameterType="java.lang.Integer">
        select * from tbl_menu m,tbl_rolemenu r where rid = #{roleid} and m.menusonid != 0 and m.menuid = r.mid
    </select>

    <resultMap id="TreeMap2" type="com.great.kindergarten.admin.javabean.MenuTreeInfo">
        <result column="mid" property="id"></result>
    </resultMap>

    <select id="findRoleInfos" resultType="com.great.kindergarten.commons.entity.TblRole">
        select * from tbl_role
        <where>
            rolename like '%管理员%'
        </where>
    </select>

    <select id="findRoleCounts" resultType="java.lang.Integer">
        select count(*) from tbl_role
        <where>
            rolename like '%管理员%'
        </where>
    </select>

    <select id="getAllMenu" resultType="com.great.kindergarten.commons.entity.TblMenu">
		select * from tbl_menu
	</select>

    <select id="findIdByKinderName" resultType="java.lang.Integer">
        select kinderid from tbl_kinder where kindername = #{kindername}
    </select>

    <select id="findIdByKinderAccount" resultType="java.lang.Integer">
        select kinderid from tbl_kinder where kinderacount = #{kinderacount}
    </select>

    <select id="selectKinderInfo" resultType="com.great.kindergarten.commons.entity.TblKinder">
        select * from tbl_kinder where kinderid = #{kinderid}
    </select>

    <select id="findAllAdmin" resultMap="AdminInfoMap" parameterType="com.great.kindergarten.commons.entity.TblAdmin">
        select a.* ,r.rolename from tbl_admin a,tbl_role r
        <where>
            a.rid = r.roleid
            <if test=" time1 != '' and time1 != null">
                <![CDATA[   and DATE_FORMAT(a.createtime, '%Y-%m-%d')>=  DATE_FORMAT(#{time1}, '%Y-%m-%d')   ]]>
            </if>
            <if test=" time2 != '' and time2 != null">
                <![CDATA[   and DATE_FORMAT(a.createtime, '%Y-%m-%d')<=  DATE_FORMAT(#{time2}, '%Y-%m-%d')   ]]>
            </if>
            <if test=" adminname != '' and adminname != null ">
                and a.adminname like concat('%',#{adminname},'%')
            </if>
            <if test=" adminstatus != '' and adminstatus != null and adminstatus != '请选择'">
                and a.adminstatus = #{adminstatus}
            </if>
            <if test=" rolename != '' and rolename != null and rolename != '请选择'">
                and r.rolename = #{rolename}
            </if>
        </where>
        order by a.createtime desc
    </select>

    <select id="findAdminCount" resultType="java.lang.Integer">
        select count(*) from tbl_admin a,tbl_role r
        <where>
            a.rid = r.roleid
            <if test=" time1 != '' and time1 != null">
                <![CDATA[   and DATE_FORMAT(a.createtime, '%Y-%m-%d')>=  DATE_FORMAT(#{time1}, '%Y-%m-%d')   ]]>
            </if>
            <if test=" time2 != '' and time2 != null">
                <![CDATA[   and DATE_FORMAT(a.createtime, '%Y-%m-%d')<=  DATE_FORMAT(#{time2}, '%Y-%m-%d')   ]]>
            </if>
            <if test=" adminname != '' and adminname != null ">
                and a.adminname like concat('%',#{adminname},'%')
            </if>
            <if test=" adminstatus != '' and adminstatus != null and adminstatus != '请选择'">
                and a.adminstatus = #{adminstatus}
            </if>
            <if test=" rolename != '' and rolename != null and rolename != '请选择'">
                and r.rolename = #{rolename}
            </if>
        </where>
        order by a.createtime desc
    </select>

    <select id="checkAdminName" resultType="com.great.kindergarten.commons.entity.TblAdmin">
        select * from tbl_admin where adminname = #{adminname}
    </select>

    <!--忘记密码的重置密码-->
    <!--    先查是不是有这个人-->
    <select id="findExistAdminName" resultType="java.lang.Integer" parameterType="java.util.Map">
        select count(*) from tbl_admin where adminname = #{adminname}
    </select>
    <select id="findAllReadBookName" resultType="java.lang.String">
        select readmagname from tbl_readmag where readmagpage = 0
    </select>

    <!--根据绘本名查找绘本信息-->
    <select id="findReadInfoByName" resultType="com.great.kindergarten.commons.entity.TblReadmag">
        select * from tbl_readmag
        <where>
            readmagpage != 0
            <if test="readmagname != '' and readmagname != null and readmagname != '请选择绘本'">
                and readmagname = #{readmagname}
            </if>
        </where>
        order by readmagpage asc
    </select>
    <select id="findReadCountByName" resultType="java.lang.Integer">
        select count(*) from tbl_readmag
        <where>
            readmagpage != 0
            <if test="readmagname != '' and readmagname != null and readmagname != '请选择绘本'">
                and readmagname = #{readmagname}
            </if>
        </where>
    </select>

    <select id="findReadMagIdByName" resultType="java.lang.Integer">
        select readmagid from tbl_readmag where readmagname = #{readmagname} and readmagpage = 0
    </select>

    <!--所有班级-->
    <select id="findAllClassName" resultType="java.lang.String">
        select distinct classname from tbl_class
    </select>

    <!--根据班级名称查找班级id-->
    <select id="findIdByClassName" resultType="java.lang.Integer">
        select classid from tbl_class where classname = #{classname}
    </select>
    <select id="findIdByRoleName" resultType="java.lang.Integer">
        select roleid from tbl_role where rolename = #{rolename}
    </select>


    <update id="resetAdminPwd" parameterType="java.util.Map">
        UPDATE tbl_admin SET adminpwd = 'e10adc3949ba59abbe56e057f20f883e' where adminname = #{adminname} and adminphone = #{adminphone};
    </update>


</mapper>